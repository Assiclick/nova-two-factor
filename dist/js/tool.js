(()=>{var t,e={523:(t,e,o)=>{Nova.booting((function(t,e,a){e.addRoutes([{name:"nova-two-factor",path:"/nova-two-factor",component:o(805).Z}])}))},429:()=>{},805:(t,e,o)=>{"use strict";o.d(e,{Z:()=>n});var a=function(t,e,o,a,n,s,r,i){var c,d="function"==typeof t?t.options:t;if(e&&(d.render=e,d.staticRenderFns=o,d._compiled=!0),a&&(d.functional=!0),s&&(d._scopeId="data-v-"+s),r?(c=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(r)},d._ssrRegister=c):n&&(c=i?function(){n.call(this,(d.functional?this.parent:this).$root.$options.shadowRoot)}:n),c)if(d.functional){d._injectStyles=c;var l=d.render;d.render=function(t,e){return c.call(e),l(t,e)}}else{var u=d.beforeCreate;d.beforeCreate=u?[].concat(u,c):[c]}return{exports:t,options:d}}({data:function(){return{twofa:[],form:{},status:{registered:!1,enabled:0,confirmed:0},loading:!0}},mounted:function(){this.getStatus(),this.getRecoveryCodes()},methods:{getStatus:function(){var t=this;Nova.request().get("/nova-vendor/nova-two-factor/status").then((function(e){t.status=e.data,t.loading=!1}))},getHome:function(){window.location.href="/admin"},getRecoveryCodes:function(){var t=this;Nova.request().get("/nova-vendor/nova-two-factor/register").then((function(e){t.twofa=e.data}))},toggle:function(){var t=this;Nova.request().post("/nova-vendor/nova-two-factor/toggle",{status:this.status.enabled}).then((function(e){t.$toasted.show(e.data.message,{type:"success"})}))},confirmOtp:function(){var t=this;Nova.request().post("/nova-vendor/nova-two-factor/confirm",this.form).then((function(e){t.$toasted.show(e.data.message,{type:"success"}),t.getHome()})).catch((function(e){t.$toasted.show(e.response.data.message,{type:"error"})}))},autoSubmit:function(){6===this.form.otp.length&&this.confirmOtp()},downloadAsText:function(t,e){var o=document.createElement("a");o.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(e)),o.setAttribute("download",t),o.style.display="none",document.body.appendChild(o),o.click(),document.body.removeChild(o)}}},(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("loading-view",{attrs:{loading:t.loading}},[o("heading",{staticClass:"mb-6"},[t._v(t._s(t.__("Two factor auth")))]),t._v(" "),o("loading-card",{staticClass:"card",attrs:{loading:t.loading}},[1==t.status.confirmed?o("div",{staticClass:"p-3"},[o("p",{staticClass:"mb-4"},[t._v("\n        "+t._s(t.__("Update your two factor security settings"))+"\n      ")]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.status.enabled,expression:"status.enabled"}],attrs:{type:"radio",name:"status",id:"s1"},domProps:{value:1,checked:t._q(t.status.enabled,1)},on:{change:function(e){return t.$set(t.status,"enabled",1)}}}),t._v(" "),o("label",{attrs:{for:"s1"}},[t._v(t._s(t.__("Enabled")))]),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.status.enabled,expression:"status.enabled"}],attrs:{type:"radio",name:"status",id:"s2"},domProps:{value:0,checked:t._q(t.status.enabled,0)},on:{change:function(e){return t.$set(t.status,"enabled",0)}}}),t._v(" "),o("label",{attrs:{for:"s2"}},[t._v(t._s(t.__("Disabled")))]),t._v(" "),o("br"),t._v(" "),o("button",{staticClass:"mt-2 btn btn-default btn-primary",on:{click:t.toggle}},[t._v("\n        "+t._s(t.__("Update"))+"\n      ")])]):o("div",{staticClass:"p-3"},[o("h3",{staticClass:"p-3"},[t._v("\n        "+t._s(t.__("What is Two-Factor Authentication?"))+"\n      ")]),t._v(" "),o("p",{staticClass:"p-2"},[t._v("\n        "+t._s(t.__("Two factor authentication (2FA) strengthens access security by requiring two methods (also referred to as factors) to verify your identity. Two factor authentication protects against phishing, social engineering and password brute force attacks and secures your logins from attackers exploiting weak or stolen credentials."))+"\n      ")]),t._v(" "),o("p",{staticClass:"p-2"},[t._v("\n        "+t._s(t.__("After enabling this feature, you will need your password, along with the code generated by a dedicated application."))+"\n      ")]),t._v(" "),o("p",{staticClass:"p-2"},[t._v("\n        "+t._s(t.__("Instead of just entering a password to log in, you'll also need to enter a passcode or use a security key. This extra step helps ensure that you, and only you, can access your account."))+"\n      ")]),t._v(" "),o("h3",{staticClass:"px-2 mt-3"},[t._v(t._s(t.__("Recovery code")))]),t._v(" "),o("p",{staticClass:"p-2"},[t._v("\n        "+t._s(t.__("In case you no longer have access to your device, you can use this code to verify your identity."))+"\n      ")]),t._v(" "),o("p",{staticClass:"p-2 no-print"},[o("strong",[t._v("\n          "+t._s(t.__("Write it down or take a screenshot and keep it somewhere safe. This code can only be used once."))+"\n        ")])]),t._v(" "),o("div",{staticClass:"p-3 my-2 text-center text-red-900 rec-box"},[o("h2",{staticClass:"mb-2"},[t._v(t._s(t.twofa.recovery))]),t._v(" "),o("a",{attrs:{href:"#"},on:{click:function(e){return e.preventDefault(),t.downloadAsText("recover_code.txt",t.twofa.recovery)}}},[t._v(t._s(t.__("Download")))])]),t._v(" "),o("h3",{staticClass:"px-2 mt-3"},[t._v(t._s(t.__("Google Authenticator")))]),t._v(" "),o("p",{staticClass:"p-2"},[t._v("\n        "+t._s(t.__("To use two-factor authentication, you need to have the Google Authenticator app installed on your phone."))+"\n      ")]),t._v(" "),o("div",{staticClass:"flex items-center my-4 text-center"},[o("a",{staticClass:"w-1/2 mx-2",attrs:{href:"https://apps.apple.com/lv/app/google-authenticator/id388497605",target:"_blank"}},[t._v("\n          "+t._s(t.__("Apple version"))+"\n        ")]),t._v(" "),o("a",{staticClass:"w-1/2 mx-2",attrs:{href:"https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=it&gl=IT",target:"_blank"}},[t._v("\n          "+t._s(t.__("Android version"))+"\n        ")])]),t._v(" "),o("h3",{staticClass:"px-2 mt-3"},[t._v("\n        "+t._s(t.__("Turn on two-factor authentication"))+"\n      ")]),t._v(" "),o("div",{staticClass:"p-3"},[o("p",[t._v("\n          "+t._s(t.__("Scan this QR code using the Google Authenticator app and enter the generated OTP code"))+"\n        ")]),t._v(" "),o("div",{staticClass:"mt-3 text-center"},[o("img",{attrs:{width:"150",src:t.twofa.google2fa_url,alt:"qr_code"}})]),t._v(" "),o("br"),t._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:t.form.otp,expression:"form.otp"}],staticClass:"w-full mb-2 form-control form-input form-input-bordered",attrs:{placeholder:"OTP",type:"text"},domProps:{value:t.form.otp},on:{keyup:function(e){return t.autoSubmit()},input:function(e){e.target.composing||t.$set(t.form,"otp",e.target.value)}}}),t._v(" "),o("button",{staticClass:"btn btn-default btn-primary",on:{click:t.confirmOtp}},[t._v("\n          "+t._s(t.__("Activate"))+"\n        ")])])])])],1)}),[],!1,null,null,null);const n=a.exports}},o={};function a(t){var n=o[t];if(void 0!==n)return n.exports;var s=o[t]={exports:{}};return e[t](s,s.exports,a),s.exports}a.m=e,t=[],a.O=(e,o,n,s)=>{if(!o){var r=1/0;for(l=0;l<t.length;l++){for(var[o,n,s]=t[l],i=!0,c=0;c<o.length;c++)(!1&s||r>=s)&&Object.keys(a.O).every((t=>a.O[t](o[c])))?o.splice(c--,1):(i=!1,s<r&&(r=s));if(i){t.splice(l--,1);var d=n();void 0!==d&&(e=d)}}return e}s=s||0;for(var l=t.length;l>0&&t[l-1][2]>s;l--)t[l]=t[l-1];t[l]=[o,n,s]},a.d=(t,e)=>{for(var o in e)a.o(e,o)&&!a.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:e[o]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={103:0,990:0};a.O.j=e=>0===t[e];var e=(e,o)=>{var n,s,[r,i,c]=o,d=0;if(r.some((e=>0!==t[e]))){for(n in i)a.o(i,n)&&(a.m[n]=i[n]);if(c)var l=c(a)}for(e&&e(o);d<r.length;d++)s=r[d],a.o(t,s)&&t[s]&&t[s][0](),t[s]=0;return a.O(l)},o=self.webpackChunk=self.webpackChunk||[];o.forEach(e.bind(null,0)),o.push=e.bind(null,o.push.bind(o))})(),a.O(void 0,[990],(()=>a(523)));var n=a.O(void 0,[990],(()=>a(429)));n=a.O(n)})();